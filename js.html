<script>

    function crearTablaContactos()
    {
        let tabla = document.getElementById('tablaContactos'); /* Tratamos de seleleccionar la tabla para comprobar si existe por que más adelante se crea una tabla con ese id */
        if (tabla) tabla.remove();
        /* ObtenerContactos() es la función que se programa en el archivo funciones.js */
        google.script.run.withSuccessHandler(/* aquí se escribe la función que trabajará con los valores devueltos por la función obtener contactos. que recuerda que es un array */
            function(obj)
            {   
                
                /* create elemen sirve para crear un elemento de tipo HTML */
                tabla = document.createElement('table');
                tabla.id = 'tablaContactos' /* Colocamos un id para que cuando aplanemos mostrar tabla compruebe si existe  */

                let tablaHeader = document.createElement('thead'); /* Interferir el bucle para que en la primera iteración determinemos cual es el encabezado. */
                let tablaBody = document.createElement('tbody');
                
                /* Crear tabla con bucle forEach*/
                /*   Array.from(obj).forEach((filaActual,i) =>
                {
                    let fila = document.createElement('tr');
                    filaActual.forEach(celdaActual =>
                    {
                        let celda = document.createElement('td');
                        celda.textContent = celdaActual;
                        fila.appendChild(celda);
                    });
                    if(i === 0){
                        tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    }
                    else
                    {
                        tablaBody.appendChild(fila);
                    }
                    
                });  */

                /* Crear tabla con bucle for */
                /* Header de la tabla */
                let primeraFila = document.createElement('tr');
                for(let i = 0; i < obj[0].length; i++){
                    let celda = document.createElement('td');
                    celda.textContent = obj[0][i];
                    primeraFila.appendChild(celda);
                    
                }
                    tablaHeader.appendChild(primeraFila);
                    tabla.appendChild(tablaHeader);
                /* Body de la tabla */
                for(let i = 1; i < obj.length; i++){
                    let fila = document.createElement('tr');
                    for (let j = 0; j < obj[i].length; j++){
                        let celda = document.createElement('td');
                        celda.textContent = obj[i][j];
                        fila.appendChild(celda);
                    } 
                    tablaBody.appendChild(fila);
                    
                }
                /* Agregamos clases a la cabecera */
                tablaHeader.classList.add('table-dark');
                /* Agregamos el cuerpo a la tabla */
                tabla.appendChild(tablaBody);
                /* Agregamos clases a la tabla */
                tabla.classList.add('table', 'table-striped', 'border', 'border-3',);
                /* Agregamos tabla a la página */
                document.getElementById('divContactos').appendChild(tabla);
            }
        ).obtenerContactos();
    }
</script>